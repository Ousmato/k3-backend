import{a as ne,b,c as se}from"./chunk-MMUNQ446.js";import{a as ve}from"./chunk-UJYHWII2.js";import{$ as U,A as h,Ab as j,C as c,Cb as oe,D as k,Db as re,E as pe,Fa as q,Ga as S,Ha as z,I as a,Ia as H,J as s,K as C,L as N,M as B,Ma as J,N as y,Na as K,O as u,P as l,Pa as ue,Qa as Q,R as w,Ta as X,U as p,Ua as Y,V as D,Va as Z,W as P,Wa as ee,X as M,Xa as ge,Z as W,Za as te,_ as $,ca as me,cb as fe,k as le,la as he,m as de,ma as L,na as A,o as I,qb as G,r as v,s as x,sa as _e,ub as ie,vb as R,x as r,y as m,za as F}from"./chunk-Q3UIBATL.js";import{a as E,b as O}from"./chunk-OXVY4BEJ.js";var ae=(()=>{class n{constructor(e){this.http=e,this.baseUrl=`${fe.apiUrl}api-salle/`}getAll(){return this.http.get(this.baseUrl+"list-all-salle")}getAll_non_occuper(){return this.http.get(this.baseUrl+"list-salle-non-occuper")}add_salle(e){return this.http.post(this.baseUrl+"add",e)}getSallesOccuper(){return this.http.get(this.baseUrl+"all-salles-ocuper")}getNombreSalleNonOccupe(){return this.http.get(this.baseUrl+"number-salle-non-occupe")}getNombreSalleOccupe(){return this.http.get(this.baseUrl+"number-salle-occupe")}getSalleByNom(e){return this.http.post(this.baseUrl+"get-salle-by-nom",e)}static{this.\u0275fac=function(t){return new(t||n)(de(_e))}}static{this.\u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function Me(n,d){if(n&1){let e=y();N(0),a(1,"p",18),u("click",function(){let i=v(e).$implicit,o=l(2);return x(o.chose_teacher(i))}),p(2),s(),B()}if(n&2){let e=d.$implicit;r(2),M("",e.nom," ",e.prenom,"")}}function Ae(n,d){if(n&1){let e=y();a(0,"div",12)(1,"div",13)(2,"div",14),C(3,"fa-icon",15),a(4,"input",16),u("input",function(){v(e);let i=l();return x(i.onSearchChange())}),U("ngModelChange",function(i){v(e);let o=l();return $(o.searchTerm,i)||(o.searchTerm=i),x(i)}),s()(),h(5,Me,3,2,"ng-container",17),s()()}if(n&2){let e=l();r(3),c("icon",e.icons.search),r(),W("ngModel",e.searchTerm),r(),c("ngForOf",e.filteredItems)}}function Fe(n,d){if(n&1&&(a(0,"option",19),p(1),s()),n&2){let e=d.$implicit;c("value",e.value),r(),P("",e.key," ")}}function Ge(n,d){if(n&1&&(a(0,"div",27)(1,"div",28)(2,"label",29),p(3),s(),C(4,"input",30),s()()),n&2){let e=d.$implicit;r(2),w("for","inlineRadio",e.day,""),r(),D(e.day),r(),w("id","inlineRadio",e.day,""),c("value",e.date)}}function Re(n,d){if(n&1&&(a(0,"label"),p(1),s()),n&2){let e=l().$implicit;r(),M("",e.nom," ",e.prenom,"")}}function je(n,d){if(n&1){let e=y();a(0,"div",37)(1,"input",38),u("change",function(i){let o=v(e).$implicit,_=l().$implicit,g=l(2);return x(g.group_check(_.idEnseignant,o.id,i))}),s(),a(2,"label",39),p(3),s()()}if(n&2){let e=d.$implicit,t=l().$implicit,i=l(2);r(),w("id","inlineRadio",e.id,""),c("value",e.id)("checked",i.isGroupSelected(t.idEnseignant,e.id))("disabled",i.isGroupAlreadySelected(e.id)),r(),c("for","inlineRadio"+e.id),r(),P(" ",e.idStudentGroup.nom," ")}}function Ve(n,d){if(n&1&&(a(0,"option",19),p(1),s()),n&2){let e=d.$implicit;c("value",e.id),r(),D(e.nom)}}function Ne(n,d){if(n&1){let e=y();a(0,"div",31),h(1,Re,2,2,"label",32),a(2,"div",33),h(3,je,4,7,"div",34),s(),a(4,"div",35)(5,"select",36),u("change",function(i){let o=v(e).$implicit,_=l(2);return x(_.onRoomChange(o.idEnseignant,i))}),a(6,"option",8),p(7,"Salles"),s(),h(8,Ve,2,2,"option",9),s()()()}if(n&2){let e=d.$implicit,t=l(2);r(),c("ngIf",t.is_Teacher_checked(e)),r(2),c("ngForOf",t.participants),r(2),k("is-invalid",t.form_config.get("idSalle").invalid&&t.form_config.get("idSalle").touched),r(3),c("ngForOf",t.salles)}}function Be(n,d){if(n&1&&(a(0,"div",20)(1,"div",21),h(2,Ge,5,6,"div",22),s(),a(3,"div",23),h(4,Ne,9,5,"div",24),s(),a(5,"div",25)(6,"button",26),p(7,"Enregistrer"),s()()()),n&2){let e=l();r(2),c("ngForOf",e.datesWithDays),r(2),c("ngForOf",e.list_enseignant_checked)}}var ke=(()=>{class n{constructor(e,t,i,o,_,g,T,f,V){this.teacherService=e,this.salleService=t,this.sideBareService=i,this.studentService=o,this.seanceService=_,this.icons=g,this.fb=T,this.root=f,this.pageTitle=V,this.searchTerm="",this.filteredItems=[],this.datesWithDays=[],this.overlay=!1,this.show_views=!1,this.isContente=!1,this.plag_check=[],this.list_checked=[],this.enseignants=[],this.list_enseignant_checked=[],this.listParticip_checked=[],this.participants=[],this.salles=[],this.seanceTypeOptions=[],this.selectedGroup={},this.selectedGroupAndRoom={}}ngOnInit(){this.load_DtoList(),this.load_salles(),this.load_form(),this.getStatusOptions(),this.sideBareService.currentSearchTerm.subscribe(e=>{this.searchTerm=e,this.filterTeachers()})}load_DtoList(){this.root.queryParams.subscribe(e=>{this.url_typeSeance=e.choix})}load_form(){this.form_config=this.fb.group({idParticipant:["",S.required],idSalle:["",S.required],seanceType:["",S.required],heureDebut:["",S.required],heureFin:["",S.required],date:["",S.required]})}getAllTeacherByIdUe(){let e=this.currentEmploi.idClasse.idFiliere?.idFiliere.id;this.teacherService.getAll_Teacher_By_IdUe(e).subscribe(t=>{this.enseignants=t,this.filteredItems=this.enseignants})}load_participation_by_classe(e){this.studentService.getParticipantsByEmploiId(e).subscribe(t=>{t.forEach(i=>{this.participants.some(o=>o.idStudentGroup.id==i.idStudentGroup.id)||this.participants.push(i)})})}teacher_check(e){let t=this.enseignants.find(o=>o.idEnseignant==e),i=this.currentEmploi;this.load_participation_by_classe(i.idClasse.id),t&&(this.list_enseignant_checked.some(o=>o.idEnseignant==e)||(this.list_enseignant_checked.length>=2?this.list_enseignant_checked=[t]:this.list_enseignant_checked.push(t)),this.form_config.reset(),this.load_form(),console.log(this.list_enseignant_checked,"checked","unchecked"))}onRoomChange(e,t){let i=t.target.value;this.selectedGroupAndRoom[e]=O(E({},this.selectedGroupAndRoom[e]),{roomId:i})}is_Teacher_checked(e){return this.list_enseignant_checked.some(t=>t==e)}load_salles(){this.salleService.getAll().subscribe(e=>{this.salles=e})}onSubmit(){let e=this.form_config.value;console.log(e,"form data");let t=[];for(let i in this.selectedGroupAndRoom)if(this.selectedGroupAndRoom.hasOwnProperty(i)){let o=this.selectedGroupAndRoom[i],_=this.enseignants.find(f=>f.idEnseignant==+i),g=this.salles.find(f=>f.id==o.roomId);console.log(_,"teacher"),console.log(g,"sallle");let T={date:e.date,heureDebut:e.heureDebut,heureFin:e.heureFin,idEmplois:this.currentEmploi,idTeacher:_,idSalle:g,seanceType:e.seanceType};t.push(T)}console.log(t,"dto"),this.seanceService.addSurveillance(t).subscribe({next:i=>{this.pageTitle.showSuccessToast(i.message),this.form_config.reset(),this.selectedGroupAndRoom={},this.list_enseignant_checked=[],this.list_checked=[]},error:i=>{this.pageTitle.showErrorToast(i.error.message)}})}getStatusOptions(){Object.keys(b).map(t=>({key:t,value:b[t]})).forEach(t=>{(t.value==b.SESSION||t.value==b.Examen)&&this.seanceTypeOptions.push(t)})}is_Particip_checked(e){return this.listParticip_checked.some(t=>t===e)}isGroupAlreadySelected(e){return Object.values(this.selectedGroupAndRoom).some(t=>t.groupId===e)}isGroupSelected(e,t){return this.selectedGroup[e]===t}group_check(e,t,i){i.target.checked&&(this.selectedGroupAndRoom[e]=O(E({},this.selectedGroupAndRoom[e]),{groupId:t})),console.log(this.selectedGroupAndRoom,"group selected")}chose_teacher(e){this.teacher_check(e.idEnseignant),this.is_Teacher_checked(e),this.show_views=!1}show_teachers(){this.show_views=!this.show_views,this.getAllTeacherByIdUe()}filterTeachers(){return console.log(this.searchTerm,"cherche"),this.searchTerm?this.filteredItems=this.enseignants.filter(e=>e.nom.toLowerCase().includes(this.searchTerm.toLowerCase())||e.prenom.toLowerCase().includes(this.searchTerm.toLowerCase())):this.filteredItems=this.enseignants}onSearchChange(){this.sideBareService.changeSearchTerm(this.searchTerm)}static{this.\u0275fac=function(t){return new(t||n)(m(ne),m(ae),m(ie),m(j),m(se),m(G),m(te),m(F),m(re))}}static{this.\u0275cmp=I({type:n,selectors:[["app-sec-add-surveillance"]],inputs:{currentEmploi:"currentEmploi",datesWithDays:"datesWithDays"},decls:22,vars:8,consts:[["class","modal-search",4,"ngIf"],[3,"ngSubmit","formGroup"],[1,"input-time"],[1,""],["type","time","id","heureDebut","formControlName","heureDebut",1,"form-control","input-width"],["type","time","id","heureFin","formControlName","heureFin",1,"form-control"],["id","type-seance",1,"form","form-group"],["formControlName","seanceType",1,"form-select"],["selected","","disabled","","value",""],[3,"value",4,"ngFor","ngForOf"],[1,"chose_teacher",3,"click"],["class","contenair-teach",4,"ngIf"],[1,"modal-search"],[1,"views"],[1,"form-input"],[1,"search-icon",3,"icon"],["type","text","placeholder","Rechercher...",1,"search",3,"input","ngModelChange","ngModel"],[4,"ngFor","ngForOf"],[3,"click"],[3,"value"],[1,"contenair-teach"],[1,"plage-days"],["class","input-content",4,"ngFor","ngForOf"],[1,"plag","plag-enseignat"],["class","plage-container",4,"ngFor","ngForOf"],[1,"button-cash"],["type","submit",1,"btn"],[1,"input-content"],[1,"input"],[3,"for"],["type","radio","formControlName","date",3,"value","id"],[1,"plage-container"],[4,"ngIf"],[1,"group"],["class","form-check form-check-inline",4,"ngFor","ngForOf"],[1,"plag-enseignat"],["formControlName","idSalle",1,"form-select",3,"change"],[1,"form-check","form-check-inline"],["type","radio","name","groupSelection",1,"form-check-input",3,"change","value","checked","disabled","id"],[1,"form-check-label",3,"for"]],template:function(t,i){t&1&&(a(0,"main"),h(1,Ae,6,3,"div",0),a(2,"form",1),u("ngSubmit",function(){return i.onSubmit()}),a(3,"div",2)(4,"div",3)(5,"label"),p(6,"Heure de d\xE9but :"),s(),C(7,"input",4),s(),a(8,"div",3)(9,"label"),p(10,"Heure de Fin :"),s(),C(11,"input",5),s()(),a(12,"div",6)(13,"label"),p(14,"Types :"),s(),a(15,"select",7)(16,"option",8),p(17,"Choisir Le type"),s(),h(18,Fe,2,2,"option",9),s()(),a(19,"label",10),u("click",function(){return i.show_teachers()}),p(20,"Selectionner Enseignants"),s(),h(21,Be,8,2,"div",11),s()()),t&2&&(r(),c("ngIf",i.show_views),r(),c("formGroup",i.form_config),r(5),k("is-invalid",i.form_config.get("heureDebut").invalid&&i.form_config.get("heureDebut").touched),r(4),k("is-invalid",i.form_config.get("heureFin").invalid&&i.form_config.get("heureFin").touched),r(7),c("ngForOf",i.seanceTypeOptions),r(3),c("ngIf",i.list_enseignant_checked.length))},dependencies:[L,A,K,Z,ee,q,Y,ue,z,H,J,Q,X,R],styles:["main[_ngcontent-%COMP%]{height:80vh}.plag[_ngcontent-%COMP%]{margin-top:10px;display:grid;grid-template-columns:repeat(3,1fr);gap:5%}.input-content[_ngcontent-%COMP%]{cursor:pointer;display:flex;width:50%;font-size:12px;align-items:center;border:1px solid var(--tertiary);border-radius:5px;padding:5px;transition:background-color .2s ease}.input-content[_ngcontent-%COMP%]:hover{background-color:var(--tertiary);color:var(--primary)}.contenair-teach[_ngcontent-%COMP%]{margin-top:10px;padding:10px;border:1px solid var(--tertiary);border-radius:5px}.color-red[_ngcontent-%COMP%]{background-color:red}.plag-enseignat[_ngcontent-%COMP%]{gap:10px;margin-top:10px}.input-time[_ngcontent-%COMP%]{display:flex;gap:20px}.plage-days[_ngcontent-%COMP%]{display:flex;gap:5%;margin-top:10px}.group[_ngcontent-%COMP%]{margin-top:10px}#type-seance[_ngcontent-%COMP%]{width:238px}.input[_ngcontent-%COMP%]{display:flex;justify-content:space-between;width:100%}.form-group[_ngcontent-%COMP%]{margin:10px 0}.chose_teacher[_ngcontent-%COMP%]{font-size:14px;background-color:var(--primary);cursor:pointer;color:var(--secondary);padding:5px;border-radius:4px}.chose_teacher[_ngcontent-%COMP%]:hover{background-color:var(--secondary);color:var(--primary)}button[_ngcontent-%COMP%]{border:none;padding:5px;background-color:var(--primary);cursor:pointer;color:var(--secondary);margin-top:20px;border-radius:5px}button[_ngcontent-%COMP%]:hover{background-color:var(--secondary);color:var(--primary)}.modal-search[_ngcontent-%COMP%]{position:relative;width:100%;display:flex;justify-content:center;align-items:center;margin-bottom:10px}.views[_ngcontent-%COMP%]{position:absolute;top:10px;width:500px;border:1px solid var(--tertiary);border-radius:5px;padding:10px;transition:background-color .2s ease;background-color:#fff;box-shadow:0 4px 8px #00000026}.views[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding:5px 30px;width:100%;margin-bottom:10px;border:1px solid var(--tertiary);border-radius:4px}.views[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none}.views[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{padding:4px;font-size:16px;margin:0;text-align:left}.views[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]:hover{color:var(--primary);background-color:var(--tertiary)}.form-input[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center}.search-icon[_ngcontent-%COMP%]{position:absolute;left:10px;bottom:15px;pointer-events:none}input[_ngcontent-%COMP%]:focus, select[_ngcontent-%COMP%]:focus{outline:none;border:1px solid var(--primary);box-shadow:0 0 5px var(--primary)}.is-invalid[_ngcontent-%COMP%]{border:1px solid red;box-shadow:0 0 5px red}"]})}}return n})();var $e=n=>({"custom-checked":n});function Ue(n,d){if(n&1){let e=y();N(0),a(1,"p",14),u("click",function(){let i=v(e).$implicit,o=l(2);return x(o.chose_teacher(i))}),p(2),s(),B()}if(n&2){let e=d.$implicit;r(2),M("",e.nom," ",e.prenom,"")}}function Le(n,d){if(n&1){let e=y();a(0,"div",8)(1,"div",9)(2,"div",10),C(3,"fa-icon",11),a(4,"input",12),u("input",function(){v(e);let i=l();return x(i.onSearchChange())}),U("ngModelChange",function(i){v(e);let o=l();return $(o.searchTerm,i)||(o.searchTerm=i),x(i)}),s()(),h(5,Ue,3,2,"ng-container",13),s()()}if(n&2){let e=l();r(3),c("icon",e.icons.search),r(),W("ngModel",e.searchTerm),r(),c("ngForOf",e.filteredItems)}}function qe(n,d){if(n&1&&(a(0,"label"),p(1),s()),n&2){let e=l().$implicit;r(),M("",e.nom," ",e.prenom,"")}}function ze(n,d){if(n&1){let e=y();a(0,"div",29)(1,"div",30)(2,"label"),p(3),s(),a(4,"input",31),u("change",function(i){let o=v(e).$implicit,_=l(2).$implicit,g=l(2);return x(g.day_check(_.idEnseignant,o.date,i))}),s()()()}if(n&2){let e=d.$implicit,t=l(2).$implicit,i=l(2);r(3),D(e.day.charAt(0)),r(),c("checked",i.is_checked(t.idEnseignant,e.date))("ngClass",me(3,$e,i.is_checked(t.idEnseignant,e.date)))}}function He(n,d){if(n&1&&(a(0,"div",27),h(1,ze,5,5,"div",28),s()),n&2){let e=l(3);r(),c("ngForOf",e.datesWithDays)}}function Je(n,d){if(n&1){let e=y();a(0,"div",34)(1,"input",35),u("change",function(i){let o=v(e).$implicit,_=l(2).$implicit,g=l(2);return x(g.group_check(_.idEnseignant,o.id,i))}),s(),a(2,"label",36),p(3),s()()}if(n&2){let e=d.$implicit,t=l(2).$implicit,i=l(2);r(),w("id","inlineRadio",e.id,""),c("value",e.id)("checked",i.isGroupSelected(t.idEnseignant,e.id))("disabled",i.isGroupAlreadySelected(e.id)),r(),c("for","inlineRadio"+e.id),r(),P(" ",e.idStudentGroup.nom," ")}}function Ke(n,d){if(n&1&&(a(0,"div",32),h(1,Je,4,7,"div",33),s()),n&2){let e=l(3);r(),c("ngForOf",e.participants)}}function Qe(n,d){if(n&1&&(a(0,"option",41),p(1),s()),n&2){let e=d.$implicit;c("value",e.value),r(),P("",e.key," ")}}function Xe(n,d){if(n&1){let e=y();a(0,"div",37)(1,"label"),p(2,"Types :"),s(),a(3,"select",38),u("change",function(i){v(e);let o=l(),_=o.$implicit,g=o.index,T=l(2);return x(T.onTypeChange(_.idEnseignant,i,g+1))}),a(4,"option",39),p(5,"Choisir Le type"),s(),h(6,Qe,2,2,"option",40),s()()}if(n&2){let e=l().index,t=l(2);r(3),k("is-invalid",t.form_config.get("seanceType"+(e+1)).invalid&&t.form_config.get("seanceType"+(e+1)).touched),w("formControlName","seanceType",e+1,""),r(3),c("ngForOf",t.seanceTypeOptions)}}function Ye(n,d){if(n&1&&(a(0,"option",41),p(1),s()),n&2){let e=d.$implicit;c("value",e.id),r(),D(e.nom)}}function Ze(n,d){if(n&1){let e=y();a(0,"select",38),u("change",function(i){v(e);let o=l().$implicit,_=l(2);return x(_.onRoomChange(o.idEnseignant,i))}),a(1,"option",39),p(2,"Salles"),s(),h(3,Ye,2,2,"option",40),s()}if(n&2){let e=l().index,t=l(2);k("is-invalid",t.form_config.get("idSalle"+(e+1)).invalid&&t.form_config.get("idSalle"+(e+1)).touched),w("formControlName","idSalle",e+1,""),r(3),c("ngForOf",t.salles)}}function et(n,d){if(n&1&&(a(0,"div",20),h(1,qe,2,2,"label",21)(2,He,2,1,"div",22),a(3,"div",23),h(4,Ke,2,1,"div",24)(5,Xe,7,5,"div",25)(6,Ze,4,5,"select",26),s()()),n&2){let e=d.$implicit,t=l(2);r(),c("ngIf",t.is_Teacher_checked(e)),r(),c("ngIf",t.is_Teacher_checked(e)),r(2),c("ngIf",t.showPerTeacher[e.idEnseignant]),r(),c("ngIf",t.showPerTeacher[e.idEnseignant]),r(),c("ngIf",t.showPerTeacher[e.idEnseignant])}}function tt(n,d){if(n&1&&(a(0,"div",15)(1,"div",16),h(2,et,7,5,"div",17),s(),a(3,"div",18)(4,"button",19),p(5,"Enregistrer"),s()()()),n&2){let e=l();r(2),c("ngForOf",e.list_enseignant_checked)}}var we=(()=>{class n{constructor(e,t,i,o,_,g,T,f,V){this.teacherService=e,this.salleService=t,this.sideBareService=i,this.studentService=o,this.seanceService=_,this.icons=g,this.fb=T,this.root=f,this.pageTitle=V,this.searchTerm="",this.datesWithDays=[],this.permission=!1,this.show_views=!1,this.plag_check=[],this.list_checked=[],this.enseignants=[],this.filteredItems=[],this.list_enseignant_checked=[],this.listParticip_checked=[],this.participants=[],this.salles=[],this.teacherConf=[],this.showPerTeacher={},this.seanceTypeOptions=[],this.selectedGroup={},this.selectedGroupAndRoom={}}ngOnInit(){this.load_DtoList(),this.load_salles(),this.load_form(),this.getPermission(),this.getStatusOptions(),this.sideBareService.currentSearchTerm.subscribe(e=>{this.searchTerm=e,this.filterTeachers()})}load_DtoList(){this.root.queryParams.subscribe(e=>{this.url_typeSeance=e.choix})}load_form(){this.form_config=this.fb.group({idParticipant:[""],idSalle1:[""],idSalle2:[""],seanceType1:[""],seanceType2:[""],heureDebut:["",S.required],heureFin:["",S.required]})}getAllTeacherByIdUe(){console.log(this.currentEmploi,"---------------");let e=this.currentEmploi.idClasse.idFiliere?.idFiliere.id;this.teacherService.getAll_Teacher_By_IdUe(e).subscribe(t=>{this.enseignants=t,console.log(this.enseignants,"enseignants"),this.filteredItems=this.enseignants})}load_participation_by_emploi(e){this.studentService.getParticipantsByEmploiId(e).subscribe(t=>{t.forEach(i=>{this.participants.some(o=>o.idStudentGroup.id==i.idStudentGroup.id)||this.participants.push(i)}),console.log(this.participants,"participations")})}teacher_check(e){let t=this.enseignants.find(o=>o.idEnseignant==e),i=this.currentEmploi;this.load_participation_by_emploi(i.id),t&&(this.list_enseignant_checked.some(o=>o.idEnseignant==e)||(this.list_enseignant_checked.length>=2?this.list_enseignant_checked=[t]:this.list_enseignant_checked.push(t)),console.log(this.list_enseignant_checked,"checked","unchecked"))}group_check(e,t,i){i.target.checked&&(this.selectedGroupAndRoom[e]=O(E({},this.selectedGroupAndRoom[e]),{groupId:t})),console.log(this.selectedGroupAndRoom,"group selected")}onTypeChange(e,t,i){let o=t.target.value;this.selectedGroupAndRoom[e]=O(E({},this.selectedGroupAndRoom[e]),{seance:o}),console.log(this.selectedGroupAndRoom,"seance selected")}onRoomChange(e,t){let i=t.target.value;this.selectedGroupAndRoom[e]=O(E({},this.selectedGroupAndRoom[e]),{roomId:i}),console.log(this.selectedGroupAndRoom,"room selected")}is_Particip_checked(e){return this.listParticip_checked.some(t=>t===e)}is_Teacher_checked(e){return this.list_enseignant_checked.some(t=>t===e)}isGroupSelected(e,t){return this.selectedGroup[e]===t}isGroupAlreadySelected(e){return Object.values(this.selectedGroupAndRoom).some(t=>t.groupId===e)}load_salles(){this.salleService.getAll().subscribe(e=>{this.salles=e})}onSubmit(){let e=this.form_config.value,t=[];for(let i in this.selectedGroupAndRoom)if(this.selectedGroupAndRoom.hasOwnProperty(i)){let o=this.selectedGroupAndRoom[i],_=this.enseignants.find(f=>f.idEnseignant==+i),g=this.participants.find(f=>f.id==o.groupId),T=this.salles.find(f=>f.id==o.roomId);o.date.forEach(f=>{let V={date:f,heureDebut:e.heureDebut,heureFin:e.heureFin,idEmplois:this.currentEmploi,idTeacher:_,idSalle:T,idParticipant:g,seanceType:o.seance};t.push(V)})}console.log(t,"dto"),this.form_config.valid?this.seanceService.add_journee(t).subscribe({next:i=>{this.pageTitle.showSuccessToast(i.message),this.form_config.reset(),this.load_form(),this.selectedGroupAndRoom={},this.list_enseignant_checked=[],this.list_checked=[],this.listParticip_checked=[]},error:i=>{this.pageTitle.showErrorToast(i.error.message)}}):(this.form_config.markAllAsTouched(),console.log(this.form_config.value,"inavlod"))}getStatusOptions(){Object.keys(b).map(t=>({key:t,value:b[t]})).forEach(t=>{t.value!=b.SESSION&&t.value!=b.Examen&&this.seanceTypeOptions.push(t)})}chose_teacher(e){this.teacher_check(e.idEnseignant),this.is_Teacher_checked(e),this.show_views=!1}show_teachers(){this.show_views=!this.show_views,this.getAllTeacherByIdUe()}day_check(e,t,i){console.log(t,"date check");let o=this.selectedGroupAndRoom[e]||{groupId:0,roomId:0,date:[]};i.target.checked?o.date.includes(t)||o.date.push(t):o.date=o.date.filter(_=>_!==t),this.showPerTeacher[e]=o.date.length>0,this.selectedGroupAndRoom[e]=o,console.log(this.selectedGroupAndRoom,"abject----")}is_checked(e,t){return this.selectedGroupAndRoom[e]?.date.includes(t)||!1}areAllChecked(){return this.list_checked.length===this.datesWithDays.length}isDayAlreadySelected(e){return Object.values(this.selectedGroupAndRoom).some(t=>t.date.includes(e))}getPermission(){let e=oe()?.der;return this.admin=e,e?(this.permission=!0,!0):!1}filterTeachers(){return console.log(this.searchTerm,"cherche"),this.searchTerm?this.filteredItems=this.enseignants.filter(e=>e.nom.toLowerCase().includes(this.searchTerm.toLowerCase())||e.prenom.toLowerCase().includes(this.searchTerm.toLowerCase())):this.filteredItems=this.enseignants}onSearchChange(){this.sideBareService.changeSearchTerm(this.searchTerm)}static{this.\u0275fac=function(t){return new(t||n)(m(ne),m(ae),m(ie),m(j),m(se),m(G),m(te),m(F),m(re))}}static{this.\u0275cmp=I({type:n,selectors:[["app-der-t-d-component"]],inputs:{currentEmploi:"currentEmploi",datesWithDays:"datesWithDays"},decls:15,vars:7,consts:[["class","modal-search",4,"ngIf"],[3,"ngSubmit","formGroup"],[1,"input-time"],[1,""],["type","time","id","heureDebut","formControlName","heureDebut","required","",1,"form-control","input-width"],["type","time","id","heureFin","formControlName","heureFin","required","",1,"form-control"],[1,"chose_teacher",3,"click"],["class","contenair-teach",4,"ngIf"],[1,"modal-search"],[1,"views"],[1,"form-input"],[1,"search-icon",3,"icon"],["type","text","placeholder","Rechercher...",1,"search",3,"input","ngModelChange","ngModel"],[4,"ngFor","ngForOf"],[3,"click"],[1,"contenair-teach"],[1,"plag","plag-enseignat"],["class","plage-container",4,"ngFor","ngForOf"],[1,"button-cash"],["type","submit",1,"btn"],[1,"plage-container"],[4,"ngIf"],["class","plage-days",4,"ngIf"],[1,"plag-enseignat"],["class","group",4,"ngIf"],["class","form form-group",4,"ngIf"],["class","form-select",3,"formControlName","is-invalid","change",4,"ngIf"],[1,"plage-days"],["class","input-content",4,"ngFor","ngForOf"],[1,"input-content"],[1,"input"],["type","checkbox",3,"change","checked","ngClass"],[1,"group"],["class","form-check form-check-inline",4,"ngFor","ngForOf"],[1,"form-check","form-check-inline"],["type","radio","name","groupSelection",1,"form-check-input",3,"change","value","checked","disabled","id"],[1,"form-check-label",3,"for"],[1,"form","form-group"],[1,"form-select",3,"change","formControlName"],["selected","","disabled","","value",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(t,i){t&1&&(a(0,"main"),h(1,Le,6,3,"div",0),a(2,"form",1),u("ngSubmit",function(){return i.onSubmit()}),a(3,"div",2)(4,"div",3)(5,"label"),p(6,"Heure de d\xE9but :"),s(),C(7,"input",4),s(),a(8,"div",3)(9,"label"),p(10,"Heure de Fin :"),s(),C(11,"input",5),s()(),a(12,"label",6),u("click",function(){return i.show_teachers()}),p(13,"Selectionner Enseignants"),s(),h(14,tt,6,1,"div",7),s()()),t&2&&(r(),c("ngIf",i.show_views),r(),c("formGroup",i.form_config),r(5),k("is-invalid",i.form_config.get("heureDebut").invalid&&i.form_config.get("heureDebut").touched),r(4),k("is-invalid",i.form_config.get("heureFin").invalid&&i.form_config.get("heureFin").touched),r(3),c("ngIf",i.list_enseignant_checked.length))},dependencies:[he,L,A,K,Z,ee,q,Y,z,H,ge,J,Q,X,R],styles:[".plag[_ngcontent-%COMP%]{margin-top:10px;display:grid;grid-template-columns:repeat(3,1fr);gap:5%}.heure-content[_ngcontent-%COMP%]{cursor:pointer;display:flex;font-size:12px;align-items:center;border:1px solid var(--tertiary);border-radius:5px;padding:5px;transition:background-color .2s ease}.heure-content[_ngcontent-%COMP%]:hover{background-color:var(--tertiary);color:var(--primary)}.input-content[_ngcontent-%COMP%]{cursor:pointer;display:flex;width:50%;font-size:12px;align-items:center;border:1px solid var(--tertiary);border-radius:5px;padding:5px;transition:background-color .2s ease}.input-content[_ngcontent-%COMP%]:hover{background-color:var(--tertiary);color:var(--primary)}.contenair-teach[_ngcontent-%COMP%]{margin-top:10px;padding:10px;border:1px solid var(--tertiary);border-radius:5px}.color-red[_ngcontent-%COMP%]{background-color:red}.plag-enseignat[_ngcontent-%COMP%]{gap:10px;margin-top:10px}.input-time[_ngcontent-%COMP%]{display:flex;gap:20px}.plage-days[_ngcontent-%COMP%]{display:flex;gap:5%;margin-top:10px}.input[_ngcontent-%COMP%]{display:flex;justify-content:space-between;width:100%}.form-group[_ngcontent-%COMP%]{margin:10px 0}.chose_teacher[_ngcontent-%COMP%]{margin-top:8px;font-size:14px;cursor:pointer;background-color:var(--primary);color:var(--secondary);padding:5px;border-radius:4px}.chose_teacher[_ngcontent-%COMP%]:hover{background-color:var(--tertiary);color:var(--primary)}button[_ngcontent-%COMP%]{border:none;padding:5px;background-color:var(--primary);cursor:pointer;color:var(--secondary);margin-top:20px;border-radius:5px}button[_ngcontent-%COMP%]:hover{background-color:var(--secondary);color:var(--primary)}.modal-search[_ngcontent-%COMP%]{position:relative;width:100%;display:flex;justify-content:center;align-items:center;margin-bottom:10px}.views[_ngcontent-%COMP%]{position:absolute;top:10px;width:500px;border:1px solid var(--tertiary);border-radius:5px;padding:10px;transition:background-color .2s ease;background-color:#fff;box-shadow:0 4px 8px #00000026}.views[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding:5px 30px;width:100%;margin-bottom:10px;border:1px solid var(--tertiary);border-radius:4px}.views[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none}.views[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{padding:4px;font-size:16px;margin:0;text-align:left}.views[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]:hover{color:var(--primary);background-color:var(--tertiary)}.form-input[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center}.search-icon[_ngcontent-%COMP%]{position:absolute;left:10px;bottom:15px;pointer-events:none}input[_ngcontent-%COMP%]:focus, select[_ngcontent-%COMP%]:focus{outline:none;border:1px solid var(--primary);box-shadow:0 0 5px var(--primary)}#type-seance[_ngcontent-%COMP%]{width:238px}.is-invalid[_ngcontent-%COMP%]{border:1px solid red;box-shadow:0 0 5px red}"]})}}return n})();function nt(n,d){if(n&1&&C(0,"app-der-t-d-component",3),n&2){let e=l(2);c("datesWithDays",e.datesWithDays)("currentEmploi",e.emploi)}}function ot(n,d){if(n&1&&C(0,"app-sec-add-surveillance",3),n&2){let e=l(2);c("datesWithDays",e.datesWithDays)("currentEmploi",e.emploi)}}function rt(n,d){if(n&1&&h(0,nt,1,2,"app-der-t-d-component",2)(1,ot,1,2,"app-sec-add-surveillance",2),n&2){let e=l();c("ngIf",e.permission),r(),c("ngIf",!e.permission)}}var ft=(()=>{class n{constructor(e,t,i,o){this.root=e,this.icons=t,this.studentService=i,this.emploiService=o,this.permission=!1,this.participants=[],this.datesWithDays=[]}ngOnInit(){this.load_all(),this.getPermission()}load_all(){this.root.queryParams.subscribe(e=>{this.url_typeSeance=e.choix,this.idClass=+e.id,console.log(this.url_typeSeance,this.idClass,"url_typeSeance"),this.emploiService.getEmploisByClasse2(this.idClass).subscribe(t=>{this.emploi=t,console.log(this.emploi,"emploia");let i=this.emploi.dateDebut,o=this.emploi.dateFin;this.datesWithDays=this.emploiService.getDaysBetweenDates(i,o),console.log(this.datesWithDays,"date days "),this.load_participation_by_classe(this.idClass)})})}load_participation_by_classe(e){this.studentService.getParticipantsByEmploiId(e).subscribe(t=>{t.forEach(i=>{this.participants.some(o=>o.idStudentGroup.id==i.idStudentGroup.id)||this.participants.push(i)}),console.log(this.participants,"participations")})}goBack(){window.history.back()}getPermission(){let e=oe()?.der;return this.admin=e,e?(this.permission=!0,!0):!1}static{this.\u0275fac=function(t){return new(t||n)(m(F),m(G),m(j),m(ve))}}static{this.\u0275cmp=I({type:n,selectors:[["app-der-e-d-t"]],decls:4,vars:2,consts:[["id","back",1,"back-button",3,"click"],[3,"icon"],[3,"datesWithDays","currentEmploi",4,"ngIf"],[3,"datesWithDays","currentEmploi"]],template:function(t,i){t&1&&(a(0,"main")(1,"div",0),u("click",function(){return i.goBack()}),C(2,"fa-icon",1),s(),h(3,rt,2,2),s()),t&2&&(r(2),c("icon",i.icons.back),r(),pe(i.datesWithDays.length>0?3:-1))},dependencies:[A,R,ke,we],styles:["main[_ngcontent-%COMP%]{padding-left:10px;height:80vh}.back-button[_ngcontent-%COMP%]{width:30px;height:30px;display:flex;align-items:center;padding:8px;font-size:20px;margin:10px 0}.back-button[_ngcontent-%COMP%]:hover{background-color:var(--tertiary);color:var(--primary);border:none;border-radius:50%}"]})}}return n})();export{ae as a,ke as b,ft as c};
