import{$ as N,A as m,Ab as X,Ba as B,C as c,Cb as y,D as w,Db as Z,Fa as $,Ha as W,I as r,J as n,K as E,L as M,M as I,Ma as Y,N as P,O as x,P as p,Q as S,T as F,U as s,V as u,Va as q,W as C,Wa as U,X as T,Z as V,_ as k,ca as A,cb as G,fa as D,ma as j,na as z,o as O,oa as L,qb as H,r as _,s as f,ub as J,vb as K,x as a,y as v,za as R,zb as Q}from"./chunk-Q3UIBATL.js";var te=function(t){return t.REG="r\xE9gulier",t.PROFESSIONNEL="professionnel",t}(te||{}),b=function(t){return t[t.Inscrits=1]="Inscrits",t[t.Non_inscrit=0]="Non_inscrit",t.Tout="tout",t}(b||{});var ie=t=>({color:t});function ne(t,d){if(t&1&&(r(0,"option",17),s(1),n()),t&2){let e=d.$implicit;c("value",e.id),a(),C("Promotion ",e.ans,"")}}function oe(t,d){if(t&1&&(r(0,"option",17),s(1),n()),t&2){let e=d.$implicit;c("value",e.value),a(),u(e.key)}}function re(t,d){t&1&&(r(0,"th"),s(1,"Action"),n())}function ae(t,d){if(t&1){let e=P();r(0,"a",25),x("click",function(){_(e);let o=p(2).$implicit,l=p(2);return f(l.getStudent(o))}),E(1,"fa-icon",26),r(2,"span"),s(3),n()()}if(t&2){let e=p(4);a(),c("icon",e.permission?e.icons.eye:e.icons.userCheck),a(2),u(e.permission?"Details":"Valider")}}function se(t,d){if(t&1&&(r(0,"td")(1,"div",23),m(2,ae,4,2,"a",24),n()()),t&2){let e=p(3);a(2),c("ngIf",!e.secretaire)}}function le(t,d){if(t&1&&(r(0,"tr")(1,"td",19),s(2),n(),r(3,"td"),s(4),n(),r(5,"td"),s(6),n(),r(7,"td",20),s(8),n(),r(9,"td",20),s(10),n(),r(11,"td"),s(12),n(),r(13,"td"),s(14),n(),r(15,"td"),s(16),n(),r(17,"td",21)(18,"a"),E(19,"fa-icon",22)(20,"span"),n()(),m(21,se,3,1,"td",12),n()),t&2){let e=d.$implicit,i=d.index,o=p(2);a(2),u(i+1),a(2),u(e.idEtudiant.nom),a(2),u(e.idEtudiant.prenom),a(),S("title",e.idClasse.idFiliere==null||e.idClasse.idFiliere.idFiliere==null?null:e.idClasse.idFiliere.idFiliere.nomFiliere),a(),C(" ",e.idClasse.idFiliere==null||e.idClasse.idFiliere.idNiveau==null?null:e.idClasse.idFiliere.idNiveau.nom,""),a(),S("title",e.idClasse.idFiliere==null||e.idClasse.idFiliere.idFiliere==null?null:e.idClasse.idFiliere.idFiliere.nomFiliere),a(),C(" ",o.abreviateFiliereName(e.idClasse.idFiliere==null||e.idClasse.idFiliere.idFiliere==null?null:e.idClasse.idFiliere.idFiliere.nomFiliere),""),a(2),u(e.idEtudiant.telephone),a(2),u(e.idEtudiant.status),a(2),u(e.idEtudiant.sexe.charAt(0)),a(),S("title",e.payer?"Valider":"Non Valider"),a(2),c("icon",(e.payer,o.icons.circle))("ngStyle",A(14,ie,e.payer?"green":"red")),a(2),c("ngIf",!o.idDg&&!o.secretaire)}}function ce(t,d){if(t&1&&(M(0),m(1,le,22,16,"tr",18),I()),t&2){let e=p();a(),c("ngForOf",e.filterStudents())}}function de(t,d){t&1&&(r(0,"tr")(1,"td",27),s(2,"Aucun r\xE9sultat trouv\xE9"),n()())}function pe(t,d){if(t&1){let e=P();r(0,"button",25),x("click",function(){let o=_(e).$implicit,l=p(2);return f(l.setPage(o))}),s(1),n()}if(t&2){let e=d.$implicit,i=p(2);w("active",e===i.page),a(),C(" ",e+1," ")}}function me(t,d){if(t&1){let e=P();r(0,"div",28)(1,"button",29),x("click",function(){_(e);let o=p();return f(o.previousPage())}),E(2,"fa-icon",26),n(),m(3,pe,2,3,"button",30),r(4,"button",29),x("click",function(){_(e);let o=p();return f(o.nextPage())}),E(5,"fa-icon",26),n()()}if(t&2){let e=p();a(),c("disabled",e.page===0),a(),c("icon",e.icons.previous),a(),c("ngForOf",e.getVisiblePages()),a(),c("disabled",e.page===e.studentspage.totalPages-1),a(),c("icon",e.icons.nexte)}}var we=(()=>{class t{constructor(e,i,o,l,h,g,ee){this.service=e,this.sideBarService=i,this.route=o,this.root=l,this.icons=h,this.pageTitle=g,this.infoSchool=ee,this.searchTerm="",this.inscrits=[],this.page=0,this.size=20,this.filteredItems=[],this.pages=[],this.permission=!1,this.event_toSetPage=!1,this.value_toEvent=0,this.annees=[],this.student_etats=[]}ngOnInit(){this.getPermission(),this.loadStudents(),this.get_annees(),this.route.queryParams.subscribe(e=>{this.idDg=e.id}),this.student_etats=this.getStudentEtat(),this.currentYear=new Date().getFullYear(),this.sideBarService.currentSearchTerm.subscribe(e=>{this.searchTerm=e,this.filterStudents()})}getPermission(){let e=y()?.scolarite;return this.secretaire=y()?.secretaire,e?(this.permission=!0,!0):!1}filterStudents(){return this.searchTerm?this.filteredItems=this.inscrits.filter(e=>e.idEtudiant.nom.toLowerCase().includes(this.searchTerm.toLowerCase())||e.idEtudiant.prenom.toLowerCase().includes(this.searchTerm.toLowerCase())||e.idEtudiant.email.toLowerCase().includes(this.searchTerm.toLowerCase())||e.idEtudiant.idClasse?.idFiliere?.idFiliere.nomFiliere.toLowerCase().includes(this.searchTerm.toLowerCase())||e.idEtudiant.idClasse?.idFiliere?.idNiveau.nom?.toLowerCase().includes(this.searchTerm.toLowerCase())):this.filteredItems=this.inscrits}onChange(e){this.event_toSetPage=!0,this.inscrits=[],this.page=0,this.idAnnee=e.target.value,this.service.getAll_by_idAnnee(this.idAnnee,this.page,this.size).subscribe(i=>{this.formatedDataStudent(i)})}loadStudents(){this.service.getSudents(this.page,this.size).subscribe(e=>{this.formatedDataStudent(e)})}setPage(e){if(e>=0&&e<this.studentspage.totalPages){if(this.page=e,this.event_toSetPage){this.service.getAll_by_idAnnee(this.idAnnee,this.page,this.size).subscribe(i=>{this.formatedDataStudent(i)}),this.event_toSetPage=!1;return}this.value_toEvent===0||this.value_toEvent===b.Tout?(console.log("la page selectionner",e),this.loadStudents()):this.service.getByEtat(this.value_toEvent,this.page,this.size).subscribe(i=>{this.formatedDataStudent(i)})}}nextPage(){this.page<this.studentspage.totalPages-1&&this.setPage(this.page+1)}previousPage(){this.page>0&&this.setPage(this.page-1)}getVisiblePages(){let e=[],i=this.studentspage.totalPages,o=Math.max(0,this.page-1),l=Math.min(i-1,this.page+1);for(let h=o;h<=l;h++)e.push(h);return e}get_annees(){this.infoSchool.getAll_annee().subscribe(e=>{this.annees=e,this.annees.forEach(i=>{let l=new Date(i.debutAnnee).getFullYear();i.ans=l})})}getStudent(e){let i={queryParams:{id:e.id}};y()?.comptable?this.root.navigate(["/comptable/student-view"],i):this.root.navigate(["/r-scolarite/student-edit"],i)}getStudentView(e){let i={queryParams:{id:e}};this.root.navigate(["/secretaire/student-view"],i)}deleted_student(e){this.service.desactiveStudent(e).subscribe({next:i=>{this.pageTitle.showSuccessToast(i.message)},error:i=>{this.pageTitle.showErrorToast(i.error.message)}})}getStudentEtat(){return Object.keys(b).filter(e=>isNaN(Number(e))).map(e=>({key:e,value:b[e]}))}getEtat(e){this.inscrits=[],this.value_toEvent=e.target.value,this.value_toEvent===b.Tout?this.loadStudents():(this.page=0,this.service.getByEtat(this.value_toEvent,this.page,this.size).subscribe(i=>{this.formatedDataStudent(i)}))}formatedDataStudent(e){this.inscrits=e.content,this.inscrits.forEach(i=>{i.idEtudiant.urlPhoto=`${G.urlPhoto}${i.idEtudiant.urlPhoto}`}),this.studentspage=e,this.filteredItems=this.inscrits,this.pages=Array.from({length:e.totalPages},(i,o)=>o),console.log(this.pages,"pages")}abreviateFiliereName(e){return e.split(" ").filter(l=>l.length>3).map(l=>l[0].toUpperCase()).join("")}static{this.\u0275fac=function(i){return new(i||t)(v(X),v(J),v(R),v(B),v(H),v(Z),v(Q))}}static{this.\u0275cmp=O({type:t,selectors:[["app-etudiants"]],decls:45,vars:10,consts:[["noResults",""],[1,"content-head"],[1,"head-left"],["id","promo-seclect",3,"change"],["selected","","disabled","","value",""],[3,"value",4,"ngFor","ngForOf"],[3,"change"],["disabled","","selected","","value",""],[1,"input-search"],["type","text","placeholder","Recherche...",1,"search-input",3,"ngModelChange","ngModel"],[1,"table-container"],[1,"table","table-hover"],[4,"ngIf"],[4,"ngIf","ngIfElse"],[1,"footer"],[1,"button-navigation"],["class","pagination",4,"ngIf"],[3,"value"],[4,"ngFor","ngForOf"],[1,"numerotation-clumn"],[1,"class-name",3,"title"],[3,"title"],[3,"icon","ngStyle"],[1,"btn-contenaire"],[3,"click",4,"ngIf"],[3,"click"],[3,"icon"],["colspan","9",1,"text-center"],[1,"pagination"],[3,"click","disabled"],[3,"active","click",4,"ngFor","ngForOf"]],template:function(i,o){if(i&1){let l=P();r(0,"main")(1,"div",1)(2,"div",2)(3,"select",3),x("change",function(g){return _(l),f(o.onChange(g))}),r(4,"option",4),s(5),n(),m(6,ne,2,2,"option",5),n(),r(7,"select",6),x("change",function(g){return _(l),f(o.getEtat(g))}),r(8,"option",7),s(9,"Tout"),n(),m(10,oe,2,2,"option",5),n()(),r(11,"div",8)(12,"input",9),N("ngModelChange",function(g){return _(l),k(o.searchTerm,g)||(o.searchTerm=g),f(g)}),n()()(),r(13,"div",10)(14,"table",11)(15,"thead")(16,"tr")(17,"th"),s(18,"N\xB0 D'ordre"),n(),r(19,"th"),s(20,"Nom"),n(),r(21,"th"),s(22,"Prenom"),n(),r(23,"th"),s(24,"Niveau"),n(),r(25,"th"),s(26,"Filiere"),n(),r(27,"th"),s(28,"Telephone"),n(),r(29,"th"),s(30,"Status"),n(),r(31,"th"),s(32,"Sexe"),n(),r(33,"th"),s(34,"Etat"),n(),m(35,re,2,0,"th",12),n()(),r(36,"tbody"),m(37,ce,2,1,"ng-container",13)(38,de,3,0,"ng-template",null,0,D),n()()(),r(40,"div",14)(41,"div",15),m(42,me,6,5,"div",16),n(),r(43,"p"),s(44),n()()()}if(i&2){let l=F(39);a(5),C("Promotion ",o.currentYear,""),a(),c("ngForOf",o.annees),a(4),c("ngForOf",o.student_etats),a(2),V("ngModel",o.searchTerm),a(23),c("ngIf",!o.idDg&&!o.secretaire),a(2),c("ngIf",o.filterStudents().length)("ngIfElse",l),a(5),c("ngIf",o.inscrits.length!==0),a(2),T("page : ",o.page+1,"/",o.studentspage.totalPages,"")}},dependencies:[j,z,L,q,U,$,W,Y,K],styles:["main[_ngcontent-%COMP%]{width:100%;height:80vh;padding-top:10px}a[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-bottom:30px}th[_ngcontent-%COMP%]{background:linear-gradient(180deg,#fff,#d4d4d4)}.content-head[_ngcontent-%COMP%]{padding:0 10px;display:flex;justify-content:space-between;align-items:flex-end;margin-bottom:10px}.table-container[_ngcontent-%COMP%]{height:83%;position:relative;overflow-y:auto}.table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{position:sticky;top:0;z-index:1}.table-container[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}a[_ngcontent-%COMP%]   fa-icon[_ngcontent-%COMP%]{margin:0}.btn-contenaire[_ngcontent-%COMP%]{display:flex;justify-content:space-between;gap:10px}img[_ngcontent-%COMP%]{border-radius:100%;border:1px solid #ccc;height:50px;width:auto}span[_ngcontent-%COMP%]{margin-left:5px;font-size:10px;color:var(--primary)}.class-name[_ngcontent-%COMP%]{cursor:pointer}img[_ngcontent-%COMP%]{border-radius:100%;border:1px solid #ccc;height:50px;width:50px;object-fit:cover}select[_ngcontent-%COMP%]{height:35px;width:100px;margin-right:10px;background-color:var(--primary);color:var(--secondary);border-radius:8px;padding:0 5px;outline:none;border:none}#promo-seclect[_ngcontent-%COMP%]{width:150px}.btn-contenaire[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{width:80px;margin-left:10px;font-size:12px;cursor:pointer;border-radius:5px;padding:5px;text-align:center;border:1px solid var(--primary);color:var(--primary);transition:color .2s ease}.btn-contenaire[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{border-color:var(--secondary);background-color:var(--secondary);color:var(--primary)}.footer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:baseline;padding-bottom:10px}.button-navigation[_ngcontent-%COMP%]{width:50%;display:flex;justify-content:flex-end}.footer[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--primary);margin-right:10px}.pagination[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;margin-top:10px}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:0 5px;font-size:12px;background-color:transparent;color:var(--secondary);cursor:pointer;border:1px solid var(--secondary);border-radius:50%}.pagination[_ngcontent-%COMP%]   button.disabled[_ngcontent-%COMP%], .pagination[_ngcontent-%COMP%]   button[disabled][_ngcontent-%COMP%]{background-color:#ccc;cursor:not-allowed}.pagination[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background-color:var(--primary);color:#fff}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover:not(.disabled):not(.active){background-color:var(--secondary);color:var(--primary)}li[_ngcontent-%COMP%]{list-style-type:none;padding:8px;border:#ccc 1px solid;margin-top:8px}li[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:16px;color:var(--primary)}.img-contenaire[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:100px;width:auto;border:#ccc 1px solid;border-radius:0}.img-contenaire[_ngcontent-%COMP%]{display:flex;gap:10px;align-items:end}.classe[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:16px;font-weight:800}.pop-img[_ngcontent-%COMP%]   .icons[_ngcontent-%COMP%]   .arrow[_ngcontent-%COMP%]{font-size:4rem}select[_ngcontent-%COMP%]{margin-top:8px;border:none;outline:none}.numerotation-clumn[_ngcontent-%COMP%]{width:auto;min-width:30px;text-align:center}tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:16px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}"]})}}return t})();export{te as a,we as b};
